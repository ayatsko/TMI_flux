# within each mound, test significant differences between mound fluxes
# 'a' plot
aov.1 <- aov(flux.CH4 ~ ID_cleaned, data = mounds)
summary(aov.1)
TukeyHSD(aov.1)
par(mfrow=c(2,2))
plot(aov.1)
par(mfrow=c(1,1))
# within each sample, is mound flux different based on position?
mound1 <- mounds[mounds$sample == 'MD1',]
View(mound1)
aov.2 <- aov(flux.CH4 ~ sample, data = mound1) # note experimental switch out of CH4 flux with CH4:CO2
# within each sample, is mound flux different based on position?
mound1 <- mounds[mounds$sample == 'MD1', 'MD2']
# within each sample, is mound flux different based on position?
mound1 <- mounds[mounds$sample == 'MD1' & 'MD2']
# within each sample, is mound flux different based on position?
mound1 <- mounds[mounds$sample == 'MD1' | 'MD2']
# within each sample, is mound flux different based on position?
mound1 <- mounds[mounds$sample == c('MD1', 'MD2')]
# within each sample, is mound flux different based on position?
mound1 <- mounds[mounds$sample == c('MD1', 'MD2'),]
mounds <- CH4_fluxfinal[CH4_fluxfinal$flux_source == 'm',]
# within each sample, is mound flux different based on position?
mound1 <- mounds[mounds$sample == c('MD1', 'MD2'),]
aov.2 <- aov(flux.CH4 ~ sample, data = mound1) # note experimental switch out of CH4 flux with CH4:CO2
summary(aov.2)
# within each sample, is mound flux different based on position?
mound1 <- mounds[mounds$sample == c('MD1'),]
aov.2 <- aov(flux.CH4 ~ tag, data = mound1) # note experimental switch out of CH4 flux with CH4:CO2
summary(aov.2)
TukeyHSD(aov.2)
a1
# mounds all, colored by species
a1 <- ggplot(data = mounds, aes(x = as.factor(sample), y = flux.CH4, fill = ID_cleaned)) +
geom_boxplot()+
geom_jitter()+
theme_classic()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
ylab("CH4 flux umol/d/m2")+
labs(title = "mound")
a1
# within each sample, is mound flux different based on position?
mound11 <- mounds[mounds$sample == c('MD11'),]
View(mound11)
aov.2 <- aov(flux.CH4 ~ tag, data = mound11) # note experimental switch out of CH4 flux with CH4:CO2
summary(aov.2)
# within each sample, is mound flux different based on position?
mound4 <- mounds[mounds$sample == c('MD4'),]
aov.2 <- aov(flux.CH4 ~ tag, data = mound4) # note experimental switch out of CH4 flux with CH4:CO2
summary(aov.2)
# within each sample, is mound flux different based on position?
mound39 <- mounds[mounds$sample == c('MD39'),]
aov.2 <- aov(flux.CH4 ~ tag, data = mound39) # note experimental switch out of CH4 flux with CH4:CO2
summary(aov.2)
# within each sample, is mound flux different based on position?
mound39 <- mounds[mounds$sample == c('MD39'),]
aov.2 <- aov(flux.CH4 ~ position, data = mound39) # note experimental switch out of CH4 flux with CH4:CO2
summary(aov.2)
aov.2 <- aov(flux.CH4 ~ position, data = mound1) # note experimental switch out of CH4 flux with CH4:CO2
summary(aov.2)
aov.2 <- aov(flux.CH4 ~ position, data = mound11) # note experimental switch out of CH4 flux with CH4:CO2
summary(aov.2)
aov.2 <- aov(flux.CH4 ~ position, data = mound4) # note experimental switch out of CH4 flux with CH4:CO2
summary(aov.2)
avgflux <- aggregate(mounds$flux.CH4, list(mounds$sample), FUN=mean)
View(avgflux)
avgflux <- merge(mounds, avgflux, by = "ID_cleaned",
all.y = TRUE)
avgflux <- merge(mounds, avgflux, by = "ID_cleaned")
avgflux <- merge(mounds, avgflux, by = "ID_cleaned",)
avgflux <- left_join(avgflux, mounds, by = c("Group,1"="sample"))
avgflux <- left_join(avgflux, mounds, by = c("Group.1"="sample"))
View(avgflux)
View(avgflux)
avgflux <- aggregate(mounds$flux.CH4, list(mounds$sample), FUN=mean)
View(mounds)
y <- mounds[, c("sample", "flux_souce", "position", "ID_cleaned")]
y <- mounds[, c("sample", "flux_source", "position", "ID_cleaned")]
avgflux <- left_join(avgflux, y, by = c("Group.1"="sample"))
View(avgflux)
# average methane flux by species
ggplot(data = avgflux, aes(x = as.factor(ID_cleaned), y = x, fill = flux_source)) +
geom_boxplot()+
ylab("CH4 flux umol/d/m2")+
theme_light()
summary(avgflux$ID_cleaned)
summary(avgflux)
aov.3 <- aov(x ~ ID_cleaned, data = avgflux) # note experimental switch out of CH4 flux with CH4:CO2
summary(aov.2)
summary(aov.3)
TukeyHSD(aov.3)
# pick out top 3 by species
require(data.table)
d <- data.table(avgflux, key="ID_cleaned")
d[, head(.SD, 3), by=ID_cleaned]
y <- mounds[, c("sample", "flux_source", "ID_cleaned")]
avgflux <- left_join(avgflux, y, by = c("Group.1"="sample"))
avgflux <- aggregate(mounds$flux.CH4, list(mounds$sample), FUN=mean)
y <- mounds[, c("sample", "flux_source", "ID_cleaned")]
avgflux <- left_join(avgflux, y, by = c("Group.1"="sample"))
avgflux <- avgflux[!duplicated(avgflux)]
avgflux <- unique(avgflux)
# average methane flux by species
ggplot(data = avgflux, aes(x = as.factor(ID_cleaned), y = x, fill = flux_source)) +
geom_boxplot()+
ylab("CH4 flux umol/d/m2")+
theme_light()
aov.3 <- aov(x ~ ID_cleaned, data = avgflux) # note experimental switch out of CH4 flux with CH4:CO2
summary(aov.3)
TukeyHSD(aov.3)
# pick out top 3 by species
require(data.table)
d <- data.table(avgflux, key="ID_cleaned")
d[, head(.SD, 3), by=ID_cleaned]
# pick out top 3 by species
top <- avgflux %>%
arrange(desc(x)) %>%
group_by(ID_cleaned) %>%
slice(1:3)
top
bottom <- avgflux %>%
arrange(x) %>%
group_by(ID_cleaned) %>%
slice(1:3)
bottom
# pick out top 3 by species
top <- avgflux %>%
arrange(desc(x)) %>%
group_by(ID_cleaned) %>%
slice(1:5)
top
bottom <- avgflux %>%
arrange(x) %>%
group_by(ID_cleaned) %>%
slice(1:5)
bottom
# pick out top 3 by species
top <- avgflux %>%
arrange(desc(x)) %>%
group_by(ID_cleaned) %>%
slice(1:5)
top
df <-
structure(list(Event = structure(c(1L, 1L, 1L, 2L, 2L, 2L), .Label = c("50 yd dash",
"Hurdle"), class = "factor"), Ethnicity = structure(c(2L, 1L,
3L, 2L, 1L, 3L), .Label = c("Afr. Am", "Asian", "White"), class = "factor"),
Score = c(7L, 8L, 5L, 6L, 8L, 9L)), class = "data.frame", row.names = c(NA,
-6L))
df
df %>%
spread(Ethnicity, Score) %>%
mutate("Difference" = Asian - White) %>%
select(-Asian, -White, -`Afr. Am`)
library(tidyverse)
df %>%
spread(Ethnicity, Score) %>%
mutate("Difference" = Asian - White) %>%
select(-Asian, -White, -`Afr. Am`)
install.packages("tidyverse")
library(tidyverse)
df %>%
spread(Ethnicity, Score) %>%
mutate("Difference" = Asian - White) %>%
select(-Asian, -White, -`Afr. Am`)
df
View(mounds)
# calculate min and max flux for each sample
data_min2 <- mounds %>%
group_by(sample) %>%
summarise_at(vars(flux.CH4),
list(min = min))
data_min2
View(data_min2)
data_max2 <- mounds %>%
group_by(sample) %>%
summarise_at(vars(flux.CH4),
list(max = max))
minmax <- left_join(data_max2, data_min2, by = sample)
minmax <- rbind(data_max2, data_min2)
minmax <- merge(data_max2, data_min2, by="sample")
View(minmax)
minmax$range <- minmax$data_max2 - minmax$data_min2
minmax$range <- minmax$data_max2 - minmax$data_min2
minmax$range <- (minmax$data_max2 - minmax$data_min2)
str(minmax)
minmax$range <- NA
minmax$range <- (minmax$data_max2 - minmax$data_min2)
minmax$range <- minmax$data_max2
minmax$range <- NA
minmax$range <- minmax$data_max2
minmax$range <- 3
minmax$range <- minmax$max - minmax$min
# merge in species info
minmax <- left_join(minmax, y, by = c("Group.1"="sample"))
View(y)
# merge in species info
minmax <- left_join(minmax, y, by = "sample")
# range in intermound methane production by sample
# average methane flux by species
ggplot(data = minmax, aes(x = as.factor(ID_cleaned), y = x, fill = flux_source)) +
geom_boxplot()+
ylab("CH4 flux umol/d/m2")+
theme_light()
# range in intermound methane production by sample
# average methane flux by species
ggplot(data = minmax, aes(x = as.factor(ID_cleaned), y = range, fill = flux_source)) +
geom_boxplot()+
ylab("CH4 flux umol/d/m2")+
theme_light()
# choose 5 most variable mounds
top <- minmax %>%
arrange(desc(range)) %>%
group_by(ID_cleaned) %>%
slice(1:5)
top
minmax <- unique(minmax)
# range in intermound methane production by sample
ggplot(data = minmax, aes(x = as.factor(ID_cleaned), y = range, fill = flux_source)) +
geom_boxplot()+
ylab("CH4 flux umol/d/m2")+
theme_light()
# choose 5 most variable mounds
top <- minmax %>%
arrange(desc(range)) %>%
group_by(ID_cleaned) %>%
slice(1:5)
top
y <- mounds[, c("sample",  "ID_cleaned")]
avgflux <- left_join(avgflux, y, by = c("Group.1"="sample"))
avgflux <- unique(avgflux)
# average methane flux by species
ggplot(data = avgflux, aes(x = as.factor(ID_cleaned), y = x, fill = flux_source)) +
geom_boxplot()+
ylab("CH4 flux umol/d/m2")+
theme_light()
View(avgflux)
# subset out soils to have a df containing only mound information
```
library(ggplot2)
library(dplyr)
library(ggpubr)
CH4_fluxfinal<- read.csv("/Users/abbeyyatsko/Desktop/repos/TMI_flux/data/finalfluxes/CH4_fluxfinalTMI.csv")
species <- read.csv("/Users/abbeyyatsko/Desktop/repos/TMI_flux/data/finalfluxes/Abbey termites .xlsx - Sheet1.csv")
species <- species[c("X", "ID_cleaned")]
# merge sp and CH4flux_final, CO2_fluxfinal
species <- species %>%
rename(sample = X)
CH4_fluxfinal <- merge(CH4_fluxfinal, species, by = c("sample"))
# subset out soils to have a df containing only mound information
mounds <- CH4_fluxfinal[CH4_fluxfinal$flux_source == 'm',]
View(mounds)
# one way ANOVA
aov.1 <- aov(flux.CH4 ~ ID_cleaned, data = mounds) # note experimental switch out of CH4 flux with CH4:CO2
summary(aov.1)
TukeyHSD(aov.1)
mound1 <- mounds[mounds$sample == c('MD1'),]
aov.2 <- aov(flux.CH4 ~ position, data = mound1) # note experimental switch out of CH4 flux with CH4:CO2
summary(aov.2)
avgflux <- aggregate(mounds$flux.CH4, list(mounds$sample), FUN=mean)
y <- mounds[, c("sample",  "ID_cleaned")]
avgflux <- left_join(avgflux, y, by = c("Group.1"="sample"))
avgflux <- unique(avgflux)
# average methane flux by species
ggplot(data = avgflux, aes(x = as.factor(ID_cleaned), y = x, fill = flux_source)) +
geom_boxplot()+
ylab("CH4 flux umol/d/m2")+
theme_light()
# average methane flux by species
ggplot(data = avgflux, aes(x = as.factor(ID_cleaned), y = x)) +
geom_boxplot()+
ylab("CH4 flux umol/d/m2")+
theme_light()
aov.3 <- aov(x ~ ID_cleaned, data = avgflux)
summary(aov.3)
TukeyHSD(aov.3)
# pick out top 5 highest methane fluxes by species
top <- avgflux %>%
arrange(desc(x)) %>%
group_by(ID_cleaned) %>%
slice(1:5)
top
# pick out bottom 5 lowest methane fluxes by species
bottom <- avgflux %>%
arrange(x) %>%
group_by(ID_cleaned) %>%
slice(1:5)
bottom
# calculate min and max flux for each sample
data_min <- mounds %>%
group_by(sample) %>%
summarise_at(vars(flux.CH4),
list(min = min))
data_max <- mounds %>%
group_by(sample) %>%
summarise_at(vars(flux.CH4),
list(max = max))
minmax <- merge(data_max, data_min, by="sample")
minmax$range <- minmax$max - minmax$min
View(minmax)
# merge in species info
minmax <- left_join(minmax, y, by = "sample")
minmax <- unique(minmax)
# range in intermound methane production by sample
ggplot(data = minmax, aes(x = as.factor(ID_cleaned), y = range)) +
geom_boxplot()+
ylab("CH4 flux umol/d/m2")+
theme_light()
# choose 5 most variable mounds (greatest range)
top <- minmax %>%
arrange(desc(range)) %>%
group_by(ID_cleaned) %>%
slice(1:5)
top
# choose 5 most variable mounds (greatest range)
variable <- minmax %>%
arrange(desc(range)) %>%
group_by(ID_cleaned) %>%
slice(1:5)
variable
top <- avgflux %>%
arrange(desc(x)) %>%
group_by(ID_cleaned) %>%
slice(1:5)
top
library(ggplot2)
library(dplyr)
library(ggpubr)
CH4_fluxfinal<- read.csv("/Users/abbeyyatsko/Desktop/repos/TMI_flux/data/finalfluxes/CH4_fluxfinalTMI.csv")
species <- read.csv("/Users/abbeyyatsko/Desktop/repos/TMI_flux/data/finalfluxes/Abbey termites .xlsx - Sheet1.csv")
species <- species[c("X", "ID_cleaned")]
# merge sp and CH4flux_final, CO2_fluxfinal
species <- species %>%
rename(sample = X)
CH4_fluxfinal <- merge(CH4_fluxfinal, species, by = c("sample"))
# subset out soils to have a df containing only mound information
mounds <- CH4_fluxfinal[CH4_fluxfinal$flux_source == 'm',]
avgflux <- aggregate(mounds$flux.CH4, list(mounds$sample), FUN=mean)
y <- mounds[, c("sample",  "ID_cleaned")]
avgflux <- left_join(avgflux, y, by = c("Group.1"="sample"))
avgflux <- unique(avgflux)
# average methane flux by species
ggplot(data = avgflux, aes(x = as.factor(ID_cleaned), y = x)) +
geom_boxplot()+
ylab("CH4 flux umol/d/m2")+
theme_light()
# anova on mound averages between species
aov.3 <- aov(x ~ ID_cleaned, data = avgflux)
summary(aov.3)
TukeyHSD(aov.3)
# pick out top 5 highest methane fluxes by species
top <- avgflux %>%
arrange(desc(x)) %>%
group_by(ID_cleaned) %>%
slice(1:5)
top
# pick out bottom 5 lowest methane fluxes by species
bottom <- avgflux %>%
arrange(x) %>%
group_by(ID_cleaned) %>%
slice(1:5)
bottom
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(dplyr)
library(ggpubr)
CH4_fluxfinal<- read.csv("/Users/abbeyyatsko/Desktop/repos/TMI_flux/data/finalfluxes/CH4_fluxfinalTMI.csv")
species <- read.csv("/Users/abbeyyatsko/Desktop/repos/TMI_flux/data/finalfluxes/Abbey termites .xlsx - Sheet1.csv")
species <- species[c("X", "ID_cleaned")]
# merge sp and CH4flux_final, CO2_fluxfinal
species <- species %>%
rename(sample = X)
CH4_fluxfinal <- merge(CH4_fluxfinal, species, by = c("sample"))
# subset out soils to have a df containing only mound information
mounds <- CH4_fluxfinal[CH4_fluxfinal$flux_source == 'm',]
# one way ANOVA
aov.1 <- aov(flux.CH4 ~ ID_cleaned, data = mounds) # note experimental switch out of CH4 flux with CH4:CO2
summary(aov.1)
TukeyHSD(aov.1)
# assumptions
par(mfrow=c(2,2))
plot(aov.1)
par(mfrow=c(1,1))
avgflux <- aggregate(mounds$flux.CH4, list(mounds$sample), FUN=mean)
y <- mounds[, c("sample",  "ID_cleaned")]
avgflux <- left_join(avgflux, y, by = c("Group.1"="sample"))
avgflux <- unique(avgflux)
# average methane flux by species
ggplot(data = avgflux, aes(x = as.factor(ID_cleaned), y = x)) +
geom_boxplot()+
ylab("CH4 flux umol/d/m2")+
theme_light()
# anova on mound averages between species
aov.3 <- aov(x ~ ID_cleaned, data = avgflux)
summary(aov.3)
TukeyHSD(aov.3)
# pick out top 5 highest methane fluxes by species
top <- avgflux %>%
arrange(desc(x)) %>%
group_by(ID_cleaned) %>%
slice(1:5)
top
# pick out bottom 5 lowest methane fluxes by species
bottom <- avgflux %>%
arrange(x) %>%
group_by(ID_cleaned) %>%
slice(1:5)
bottom
merge(top, bottom)
merge(top, bottom, by = "Group.1")
View(bottom)
q1 <- rbind(top, bottom)
View(q1)
top$rank <- "top"
top
View(top)
bottom$rank <- "bottom"
bottom
q1 <- rbind(top, bottom)
View(q1)
q1 <- complete.cases(q1)
top <- avgflux %>%
arrange(desc(x)) %>%
group_by(ID_cleaned) %>%
slice(1:5)
top$rank <- "top"
top
# pick out bottom 5 lowest methane fluxes by species
bottom <- avgflux %>%
arrange(x) %>%
group_by(ID_cleaned) %>%
slice(1:5)
bottom$rank <- "bottom"
bottom
q1 <- rbind(top, bottom)
q1 <- q1[complete.cases(q1), ]
q1 <- q1[complete.cases(q1), ]
q1 <- q1 %>% mutate_all(na_if,"")
q1 <- q1[complete.cases(q1), ]
q1[q1$ID_cleaned==""] <- NA
q1[q1==""] <- NA
q1 <- na.omit(q1)
q1 <- q1 %>%
rename(species = Group.1)
q1 <- q1 %>%
rename(sample = Group.1,
x = flux)
q1 <- q1 %>%
rename(sample = Group.1,
x=flux = x)
q1 <- q1 %>%
rename(sample = Group.1,
x = flux)
top <- avgflux %>%
arrange(desc(x)) %>%
group_by(ID_cleaned) %>%
slice(1:5)
top$rank <- "top"
top
# pick out bottom 5 lowest methane fluxes by species
bottom <- avgflux %>%
arrange(x) %>%
group_by(ID_cleaned) %>%
slice(1:5)
bottom$rank <- "bottom"
bottom
q1 <- rbind(top, bottom)
q1[q1==""] <- NA
q1 <- na.omit(q1)
q1 <- q1 %>%
rename(sample = Group.1,
x = flux)
q1 <- q1 %>%
rename(sample = Group.1,
flux = x)
# export .csv
write.csv(q1, "/Users/abbeyyatsko/Downloads/q1.csv")
# calculate min and max flux for each sample
data_min <- mounds %>%
group_by(sample) %>%
summarise_at(vars(flux.CH4),
list(min = min))
data_max <- mounds %>%
group_by(sample) %>%
summarise_at(vars(flux.CH4),
list(max = max))
minmax <- merge(data_max, data_min, by="sample")
minmax$range <- minmax$max - minmax$min
# merge in species info
minmax <- left_join(minmax, y, by = "sample")
minmax <- unique(minmax)
# range in intermound methane production by sample
ggplot(data = minmax, aes(x = as.factor(ID_cleaned), y = range)) +
geom_boxplot()+
ylab("CH4 flux umol/d/m2")+
theme_light()
# choose 5 most variable mounds (greatest range)
variable <- minmax %>%
arrange(desc(range)) %>%
group_by(ID_cleaned) %>%
slice(1:5)
variable
# remove entries without species info, clean up df
q2[q2==""] <- NA
# remove entries without species info, clean up df
variable[variable==""] <- NA
View(variable)
variable <- na.omit(variable)
q2 <- variable
View(q2)
# export .csv
write.csv(q2, "/Users/abbeyyatsko/Downloads/q2.csv")
