xlab("Termite biomass (g)")+
theme(legend.position = "none")
ggplot(all_fluxes_mound_avg, aes(x = volume_m3_final, y = termite_biomass_g, color = species_s)) +
geom_point()
# 3d plot with termite_biomass_g, volume_m3_final, and mean_mound_fluxCH4
ggplot(all_fluxes_mound_avg, aes(x = termite_biomass_g, y = volume_m3_final, z = mean_mound_fluxCH4, color = species_s))+
geom_point()+
scale_color_brewer(palette = "Dark2")+
theme_classic()+
xlab("Termite biomass (g)")+
ylab("Mound volume (m3)")+
zlab("CH4 flux (umol/d/mound)")+
theme(legend.position = "none")
# 3d plot with termite_biomass_g, volume_m3_final, and mean_mound_fluxCH4
ggplot(all_fluxes_mound_avg, aes(x = termite_biomass_g, y = volume_m3_final, z = mean_mound_fluxCH4, color = species_s))+
geom_point()+
scale_color_brewer(palette = "Dark2")+
theme_classic()+
xlab("Termite biomass (g)")+
ylab("Mound volume (m3)")+
# zlab("CH4 flux (umol/d/mound)")+
theme(legend.position = "none")
library(plotly)
# 3d plot with termite_biomass_g, volume_m3_final, and mean_mound_fluxCH4
plot_ly(data = all_fluxes_mound_avg, x = ~termite_biomass_g, y = ~volume_m3_final, z = ~mean_mound_fluxCH4,
type = "scatter3d", mode = "markers",
marker = list(size = 5, color = ~mean_mound_fluxCH4, colorscale = "Viridis", showscale = TRUE)) %>%
layout(scene = list(
xaxis = list(title = "Termite Biomass (g)"),
yaxis = list(title = "Volume (m³)"),
zaxis = list(title = "Mean Mound CH4 Flux")
))
# relationship between termite biomass and CH4 flux
ggplot(all_fluxes_mound_avg, aes(x = termite_biomass_g, y = mound_CH4flux, color = species_s)) +
geom_point()+
geom_smooth(method = 'lm')+
facet_wrap(~species_s, scales = "free")+
scale_color_brewer(palette = "Dark2")+
theme_classic()+
ylab("Total mound CH4 flux (umol/d/mound)") +
xlab("Termite biomass (g)")+
theme(legend.position = "none")
# 3d plot with termite_biomass_g, volume_m3_final, and mean_mound_fluxCH4
plot_ly(data = all_fluxes_mound_avg, x = ~termite_biomass_g, y = ~volume_m3_final, z = ~mound_CH4flux,
type = "scatter3d", mode = "markers",
marker = list(size = 5, color = ~mean_mound_fluxCH4, colorscale = "Viridis", showscale = TRUE)) %>%
layout(scene = list(
xaxis = list(title = "Termite Biomass (g)"),
yaxis = list(title = "Volume (m³)"),
zaxis = list(title = "Mean Mound CH4 Flux")
))
# relationship between termite biomass and CH4 flux
ggplot(all_fluxes_mound_avg, aes(x = termite_biomass_g, y = mound_CH4flux, color = species_s)) +
geom_point()+
geom_smooth(method = 'lm')+
facet_wrap(~species_s, scales = "free")+
scale_color_brewer(palette = "Dark2")+
theme_classic()+
ylab("Total mound CH4 flux (umol/d/mound)") +
xlab("Termite biomass (g)")+
theme(legend.position = "none")
# relationship between termite biomass and CH4 flux
ggplot(all_fluxes_mound_avg, aes(x = volume_m3_final, y = mound_CH4flux, color = species_s)) +
geom_point()+
geom_smooth(method = 'lm')+
facet_wrap(~species_s, scales = "free")+
scale_color_brewer(palette = "Dark2")+
theme_classic()+
ylab("Total mound CH4 flux (umol/d/mound)") +
xlab("Termite biomass (g)")+
theme(legend.position = "none")
# relationship between termite biomass and CH4 flux
ggplot(all_fluxes_mound_avg, aes(x = termite_biomass_g, y = mound_CH4flux, color = species_s)) +
geom_point()+
geom_smooth(method = 'lm')+
facet_wrap(~species_s, scales = "free")+
scale_color_brewer(palette = "Dark2")+
theme_classic()+
ylab("Total mound CH4 flux (umol/d/mound)") +
xlab("Termite biomass (g)")+
theme(legend.position = "none")
# Q2: What is the relationship between mound size and CH4 flux?
# whole mound methane flux mound size (basal_area_m2, sa_m2_final, volume_m3_final)
mod <- lmer(mound_CH4flux ~ volume_m3_final + (1 | species_s) + (1 | sample), data = all_fluxes_mound_avg)
summary(mod)
Anova(mod)
# flux and wall thickness
ggplot(wt, aes(x = wall_thickness_mm, y = flux.CH4, color = species_s)) +
geom_point()+
geom_smooth(method = "lm")+
facet_wrap(~species_s, scales = "free")+
theme_classic()+
ylab("CH4 flux umol/d/m2")+
xlab("Mound wall thickness (mm)")+
scale_color_brewer(palette = "Dark2")+
theme(legend.position = "bottom")
# flux and wall thickness
ggplot(wt, aes(x = wall_thickness_mm, y = flux.CH4, color = species_s)) +
geom_point()+
geom_smooth(data = subset(wt, species_s == "C. acinaciformis"), method = "lm", se = FALSE) +
facet_wrap(~species_s, scales = "free")+
theme_classic()+
ylab("CH4 flux umol/d/m2")+
xlab("Mound wall thickness (mm)")+
scale_color_brewer(palette = "Dark2")+
theme(legend.position = "bottom")
# flux and wall thickness
ggplot(wt, aes(x = wall_thickness_mm, y = flux.CH4, color = species_s)) +
geom_point()+
geom_smooth(data = subset(wt, species_s == "C. acinaciformis"), method = "lm", se = T) +
facet_wrap(~species_s, scales = "free")+
theme_classic()+
ylab("CH4 flux umol/d/m2")+
xlab("Mound wall thickness (mm)")+
scale_color_brewer(palette = "Dark2")+
theme(legend.position = "bottom")
FALSE
# flux and wall thickness
ggplot(wt, aes(x = wall_thickness_mm, y = flux.CH4, color = species_s)) +
geom_point()+
geom_smooth(data = subset(wt, species_s == "C. acinaciformis"), method = "lm", se = FALSE) +
facet_wrap(~species_s, scales = "free")+
theme_classic()+
ylab("CH4 flux umol/d/m2")+
xlab("Mound wall thickness (mm)")+
scale_color_brewer(palette = "Dark2")+
theme(legend.position = "bottom")
# flux and wall thickness
a <- ggplot(wt, aes(x = wall_thickness_mm, y = flux.CH4, color = species_s)) +
geom_point()+
geom_smooth(data = subset(wt, species_s == "C. acinaciformis"), method = "lm", se = FALSE) +
facet_wrap(~species_s, scales = "free")+
theme_classic()+
ylab("CH4 flux umol/d/m2")+
xlab("Mound wall thickness (mm)")+
scale_color_brewer(palette = "Dark2")+
theme(legend.position = "bottom")
# Q2: What is the relationship between mound size and CH4 flux?
# whole mound methane flux mound size (basal_area_m2, sa_m2_final, volume_m3_final)
ggplot(all_fluxes_mound_avg, aes(x = volume_m3_final, y = mean_mound_fluxCH4, color = species_s)) +
geom_point()+
geom_smooth(method = 'lm')+
facet_wrap(~species_s, scales = "free")+
scale_color_brewer(palette = "Dark2")+
theme_classic()+
ylab("Total mound CH4 flux (umol/d/mound)") +
xlab("Mound volume (m3)")+
theme(legend.position = "none")
# Q2: What is the relationship between mound size and CH4 flux?
# whole mound methane flux mound size (basal_area_m2, sa_m2_final, volume_m3_final)
ggplot(all_fluxes_mound_avg, aes(x = volume_m3_final, y = mean_mound_fluxCH4, color = species_s)) +
geom_point()+
geom_smooth(method = 'lm', se = FALSE)+
facet_wrap(~species_s, scales = "free")+
scale_color_brewer(palette = "Dark2")+
theme_classic()+
ylab("Total mound CH4 flux (umol/d/mound)") +
xlab("Mound volume (m3)")+
theme(legend.position = "none")
# Q2: What is the relationship between mound size and CH4 flux?
# whole mound methane flux mound size (basal_area_m2, sa_m2_final, volume_m3_final)
mod <- lmer(mound_CH4flux ~ volume_m3_final + (1 | species_s) + (1 | sample), data = all_fluxes_mound_avg)
summary(mod)
# Q2: What is the relationship between mound size and CH4 flux?
# whole mound methane flux mound size (basal_area_m2, sa_m2_final, volume_m3_final)
b <- ggplot(all_fluxes_mound_avg, aes(x = volume_m3_final, y = mean_mound_fluxCH4, color = species_s)) +
geom_point()+
geom_smooth(method = 'lm', se = FALSE)+
facet_wrap(~species_s, scales = "free")+
scale_color_brewer(palette = "Dark2")+
theme_classic()+
ylab("Total mound CH4 flux (umol/d/mound)") +
xlab("Mound volume (m3)")+
theme(legend.position = "none")
ggarrange(a, b, ncol = 1)
# relationship between termite biomass and CH4 flux
ggplot(all_fluxes_mound_avg, aes(x = termite_biomass_g, y = mound_CH4flux, color = species_s)) +
geom_point()+
geom_smooth(method = 'lm')+
facet_wrap(~species_s, scales = "free")+
scale_color_brewer(palette = "Dark2")+
theme_classic()+
ylab("Total mound CH4 flux (umol/d/mound)") +
xlab("Termite biomass (g)")+
theme(legend.position = "none")
# Q2: What is the relationship between mound size and CH4 flux?
# whole mound methane flux mound size (basal_area_m2, sa_m2_final, volume_m3_final)
mod <- lmer(mound_CH4flux ~ volume_m3_final + (1 | species_s) + (1 | sample), data = all_fluxes_mound_avg)
summary(mod)
Anova(mod)
ggpredict(mod, terms = c("volume_m3_final")) %>% plot(add.data = TRUE)
mod <-  lmer(flux.CH4 ~ wall_thickness_mm + (1 | species_s) + (1 | sample), data = wt)
ggpredict(mod, terms = c("wall_thickness_mm")) %>% plot(add.data = TRUE)
Anova(mod)
# average mound size by species
ggplot(all_fluxes_mound_avg, aes(x = species_s, y = volume_m3_final, fill = species_s))+ # swap out basal_area_m2
geom_boxplot()+
theme_classic()+
xlab("")+
ylab("Mound volume (m3)")+
ggtitle("Mound volume by species")+
scale_fill_brewer(palette = "Dark2")+
theme(legend.position = "none")
ggplot(all_fluxes_mound_avg, aes(x = volume_m3_final, y = mean_mound_fluxCH4, color = species_s)) +
geom_point()+
geom_smooth(method = 'lm', se = FALSE)+
facet_wrap(~species_s, scales = "free")+
scale_color_brewer(palette = "Dark2")+
theme_classic()+
ylab("Total mound CH4 flux (umol/d/mound)") +
xlab("Mound volume (m3)")+
theme(legend.position = "none")
# test differences between species
mod <- lmer(mound_CH4flux ~ volume_m3_final*species_s + (1 | sample), data = all_fluxes_mound_avg)
Anova(mod)
ggpredict(mod, terms = c("volume_m3_final", "species_s")) %>% plot(add.data = TRUE)
ggpredict(mod, terms = c("volume_m3_final", "species_s")) %>% plot(add.data = TRUE, se = FALSE)
summary(mod)
# test differences between species
mod <- lmer(mound_CH4flux ~ volume_m3_final*species_s + (1 | sample), data = all_fluxes_mound_avg)
summary(mod)
Anova(mod)
mod <- lmer(mound_CH4flux ~ volume_m3_final + (1 | sample), data = all_fluxes_mound_avg[all_fluxes_mound_avg$species_s =="A. laurensis"])
mod <- lmer(mound_CH4flux ~ volume_m3_final + (1 | sample), data = all_fluxes_mound_avg[all_fluxes_mound_avg$species_s =="A. laurensis",])
Anova(mod)
mod <- lmer(mound_CH4flux ~ volume_m3_final + (1 | sample), data = all_fluxes_mound_avg[all_fluxes_mound_avg$species_s =="C. acinaciformis",])
Anova(mod)
mod <- lmer(mound_CH4flux ~ volume_m3_final + (1 | sample), data = all_fluxes_mound_avg[all_fluxes_mound_avg$species_s =="C. acinaciformis",])
Anova(mod)
mod <- lmer(mound_CH4flux ~ volume_m3_final + (1 | sample), data = all_fluxes_mound_avg[all_fluxes_mound_avg$species_s =="N. magnus",])
Anova(mod)
mod_ami <- lmer(mound_CH4flux ~ volume_m3_final + (1 | sample), data = all_fluxes_mound_avg[all_fluxes_mound_avg$species_s =="A. laurensis",])
Anova(mod_ami)
mod_cop <- lmer(mound_CH4flux ~ volume_m3_final + (1 | sample), data = all_fluxes_mound_avg[all_fluxes_mound_avg$species_s =="C. acinaciformis",])
Anova(mod_cop)
summary(mod_cop)
cop <- all_fluxes_mound_avg[all_fluxes_mound_avg$species_s =="C. acinaciformis",]
View(cop)
# plot cop volume vs flux
ggplot(all_fluxes_mound_avg, aes(x = volume_m3_final, y = mound_CH4flux, color = species_s)) + geom_point() + geom_smooth(method = "lm")
# plot cop volume vs flux
ggplot(cop, aes(x = volume_m3_final, y = mound_CH4flux, color = species_s)) + geom_point() + geom_smooth(method = "lm")
ggplot(all_fluxes_mound_avg, aes(x = volume_m3_final, y = mean_mound_fluxCH4, color = species_s)) +
geom_point()+
geom_smooth(method = 'lm', se = FALSE)+
facet_wrap(~species_s, scales = "free")+
scale_color_brewer(palette = "Dark2")+
theme_classic()+
ylab("Total mound CH4 flux (umol/d/mound)") +
xlab("Mound volume (m3)")+
theme(legend.position = "none")
ggplot(all_fluxes_mound_avg, aes(x = volume_m3_final, y = mound_CH4flux, color = species_s)) +
geom_point()+
geom_smooth(method = 'lm', se = FALSE)+
facet_wrap(~species_s, scales = "free")+
scale_color_brewer(palette = "Dark2")+
theme_classic()+
ylab("Total mound CH4 flux (umol/d/mound)") +
xlab("Mound volume (m3)")+
theme(legend.position = "none")
ggarrange(a, b, ncol = 1)
# Q2: What is the relationship between mound size and CH4 flux?
# whole mound methane flux mound size (basal_area_m2, sa_m2_final, volume_m3_final)
b <- ggplot(all_fluxes_mound_avg, aes(x = volume_m3_final, y = mound_CH4flux, color = species_s)) +
geom_point()+
geom_smooth(method = 'lm', se = FALSE)+
facet_wrap(~species_s, scales = "free")+
scale_color_brewer(palette = "Dark2")+
theme_classic()+
ylab("Total mound CH4 flux (umol/d/mound)") +
xlab("Mound volume (m3)")+
theme(legend.position = "none")
ggarrange(a, b, ncol = 1)
mod_ami <- lmer(mound_CH4flux ~ volume_m3_final + (1 | sample), data = all_fluxes_mound_avg[all_fluxes_mound_avg$species_s =="A. laurensis",])
summary(mod_ami)
mod_cop <- lmer(mound_CH4flux ~ volume_m3_final + (1 | sample), data = all_fluxes_mound_avg[all_fluxes_mound_avg$species_s =="C. acinaciformis",])
summary(mod_cop)
Anova(mod_cop)
mod_nas <- lmer(mound_CH4flux ~ volume_m3_final + (1 | sample), data = all_fluxes_mound_avg[all_fluxes_mound_avg$species_s =="N. magnus",])
summary(mod_nas)
ggplot(all_fluxes_mound_avg, aes(x = volume_m3_final, y = mound_CH4flux, color = species_s)) +
geom_point()+
geom_smooth(method = 'lm', se = FALSE)+
facet_wrap(~species_s, scales = "free")+
scale_color_brewer(palette = "Dark2")+
theme_classic()+
ylab("Total mound CH4 flux (umol/d/mound)") +
xlab("Mound volume (m3)")+
theme(legend.position = "none")
ggplot(all_fluxes_mound_avg, aes(x = volume_m3_final, y = mound_CH4flux, color = species_s)) +
geom_point()+
geom_smooth(data = subset(wt, species_s == "C. acinaciformis"), method = "lm", se = FALSE) +
facet_wrap(~species_s, scales = "free")+
scale_color_brewer(palette = "Dark2")+
theme_classic()+
ylab("Total mound CH4 flux (umol/d/mound)") +
xlab("Mound volume (m3)")+
theme(legend.position = "none")
# Q2: What is the relationship between mound size and CH4 flux?
# whole mound methane flux mound size (basal_area_m2, sa_m2_final, volume_m3_final)
b <- ggplot(all_fluxes_mound_avg, aes(x = volume_m3_final, y = mound_CH4flux, color = species_s)) +
geom_point()+
geom_smooth(data = subset(all_fluxes_mound_avg, species_s == "C. acinaciformis"), method = "lm", se = FALSE) +
facet_wrap(~species_s, scales = "free")+
scale_color_brewer(palette = "Dark2")+
theme_classic()+
ylab("Total mound CH4 flux (umol/d/mound)") +
xlab("Mound volume (m3)")+
theme(legend.position = "none")
ggplot(all_fluxes_mound_avg, aes(x = volume_m3_final, y = mound_CH4flux, color = species_s)) +
geom_point()+
geom_smooth(data = subset(all_fluxes_mound_avg, species_s == "C. acinaciformis"), method = "lm", se = FALSE) +
facet_wrap(~species_s, scales = "free")+
scale_color_brewer(palette = "Dark2")+
theme_classic()+
ylab("Total mound CH4 flux (umol/d/mound)") +
xlab("Mound volume (m3)")+
theme(legend.position = "none")
ggplot(all_fluxes_mound_avg, aes(x = volume_m3_final, y = mound_CH4flux, color = species_s)) +
geom_point()+
geom_smooth(data = subset(all_fluxes_mound_avg, species_s == "A. laurensis"), method = "lm", se = FALSE) +
facet_wrap(~species_s, scales = "free")+
scale_color_brewer(palette = "Dark2")+
theme_classic()+
ylab("Total mound CH4 flux (umol/d/mound)") +
xlab("Mound volume (m3)")+
theme(legend.position = "none")
ggplot(all_fluxes_mound_avg, aes(x = volume_m3_final, y = mound_CH4flux, color = species_s)) +
geom_point()+
geom_smooth(data = subset(all_fluxes_mound_avg, species_s == "A. laurensis"), method = "lm", se = FALSE) +
geom_smooth(data = subset(all_fluxes_mound_avg, species_s == "N. magnus"), method = "lm", se = FALSE) +
facet_wrap(~species_s, scales = "free")+
scale_color_brewer(palette = "Dark2")+
theme_classic()+
ylab("Total mound CH4 flux (umol/d/mound)") +
xlab("Mound volume (m3)")+
theme(legend.position = "none")
# Q2: What is the relationship between mound size and CH4 flux?
# whole mound methane flux mound size (basal_area_m2, sa_m2_final, volume_m3_final)
b <- ggplot(all_fluxes_mound_avg, aes(x = volume_m3_final, y = mound_CH4flux, color = species_s)) +
geom_point()+
geom_smooth(data = subset(all_fluxes_mound_avg, species_s == "A. laurensis"), method = "lm", se = FALSE) +
geom_smooth(data = subset(all_fluxes_mound_avg, species_s == "N. magnus"), method = "lm", se = FALSE) +
facet_wrap(~species_s, scales = "free")+
scale_color_brewer(palette = "Dark2")+
theme_classic()+
ylab("Total mound CH4 flux (umol/d/mound)") +
xlab("Mound volume (m3)")+
theme(legend.position = "none")
ggarrange(a, b, ncol = 1)
# 3d plot with termite_biomass_g, volume_m3_final, and mean_mound_fluxCH4
plot_ly(data = all_fluxes_mound_avg, x = ~termite_biomass_g, y = ~volume_m3_final, z = ~mound_CH4flux,
type = "scatter3d", mode = "markers",
marker = list(size = 5, color = ~mean_mound_fluxCH4, colorscale = "Viridis", showscale = TRUE)) %>%
layout(scene = list(
xaxis = list(title = "Termite Biomass (g)"),
yaxis = list(title = "Volume (m³)"),
zaxis = list(title = "Mound CH4 Flux")
))
View(all_fluxes_mound_avg)
xmin <- min(all_fluxes_mound_avg$termite_biomass_g)
xmax <- max(all_fluxes_mound_avg$termite_biomass_g)
ymin <- min(all_fluxes_mound_avg$volume_m3_final)
ymax <- max(all_fluxes_mound_avg$volume_m3_final)
zmin <- min(all_fluxes_mound_avg$mound_CH4flux)
zmax <- max(all_fluxes_mound_avg$mound_CH4flux)
plot_ly(data = all_fluxes_mound_avg, x = ~termite_biomass_g, y = ~volume_m3_final, z = ~mound_CH4flux,
type = "scatter3d", mode = "markers",
marker = list(size = 5, color = ~mean_mound_fluxCH4, colorscale = "Viridis", showscale = TRUE)) %>%
# Add lines for the edges of the cube
add_trace(type = "scatter3d", mode = "lines",
x = c(xmin, xmax, xmax, xmin, xmin, xmin, xmin, xmax, xmax, xmax, xmax, xmin),
y = c(ymin, ymin, ymax, ymax, ymin, ymin, ymax, ymax, ymax, ymin, ymin, ymin),
z = c(zmin, zmin, zmin, zmin, zmin, zmax, zmax, zmax, zmin, zmin, zmax, zmax),
line = list(color = 'black', width = 2)) %>%
layout(scene = list(
xaxis = list(title = "Termite Biomass (g)"),
yaxis = list(title = "Volume (m³)"),
zaxis = list(title = "Mound CH4 Flux")
))
xmin <- mean(all_fluxes_mound_avg$termite_biomass_g) + sd(all_fluxes_mound_avg$termite_biomass_g)
xmax <- mean(all_fluxes_mound_avg$termite_biomass_g) -  sd(all_fluxes_mound_avg$termite_biomass_g)
ymin <- mean(all_fluxes_mound_avg$volume_m3_final) + sd(all_fluxes_mound_avg$volume_m3_final)
ymax <- mean(all_fluxes_mound_avg$volume_m3_final) - sd(all_fluxes_mound_avg$volume_m3_final)
zmin <- mean(all_fluxes_mound_avg$mound_CH4flux) + sd(all_fluxes_mound_avg$mound_CH4flux)
zmax <- mean(all_fluxes_mound_avg$mound_CH4flux) - sd(all_fluxes_mound_avg$mound_CH4flux)
plot_ly(data = all_fluxes_mound_avg, x = ~termite_biomass_g, y = ~volume_m3_final, z = ~mound_CH4flux,
type = "scatter3d", mode = "markers",
marker = list(size = 5, color = ~mean_mound_fluxCH4, colorscale = "Viridis", showscale = TRUE)) %>%
# Add lines for the edges of the cube
add_trace(type = "scatter3d", mode = "lines",
x = c(xmin, xmax, xmax, xmin, xmin, xmin, xmin, xmax, xmax, xmax, xmax, xmin),
y = c(ymin, ymin, ymax, ymax, ymin, ymin, ymax, ymax, ymax, ymin, ymin, ymin),
z = c(zmin, zmin, zmin, zmin, zmin, zmax, zmax, zmax, zmin, zmin, zmax, zmax),
line = list(color = 'black', width = 2)) %>%
layout(scene = list(
xaxis = list(title = "Termite Biomass (g)"),
yaxis = list(title = "Volume (m³)"),
zaxis = list(title = "Mound CH4 Flux")
))
# Q1: How does CH4 flux change by season?
all_fluxes_seasonal_avg$campaign <- factor(all_fluxes_seasonal_avg$campaign, levels = c("may22", "aug23", "nov22", "feb24"))
all_fluxes_seasonal_avg$species_s <- as.factor(all_fluxes_seasonal_avg$species_s)
ggplot(all_fluxes_seasonal_avg, aes(x = campaign, y = mean_mound_fluxCH4, fill = campaign))+
geom_boxplot()+
ylab("CH4 flux umol/d/m2")+
xlab("")+
scale_x_discrete(labels = c("Wet-to-dry", "Mid-dry", "Dry-to-wet", "Mid-wet"))+
theme_classic()+
theme(legend.position = "none")
# Q1: How does CH4 flux change by season?
mod <- lmer(mean_mound_fluxCH4 ~ campaign + (1 | species_s) + (1 | sample), data = all_fluxes_seasonal_avg)
summary(mod)
emm <- emmeans(mod, ~ campaign)
pairs(emm)
# include species variation
ggplot(all_fluxes_seasonal_avg, aes(x = campaign, y = mean_mound_fluxCH4, fill = species_s))+
geom_boxplot()+
ylab("CH4 flux umol/d/m2")+
xlab("")+
scale_x_discrete(labels = c("Wet-to-dry", "Mid-dry", "Dry-to-wet", "Mid-wet"))+
scale_fill_manual(values = c("A. laurensis" = "#1b9e77", "C. acinaciformis" = "#d95f02", "N. magnus" =
"#7570b3")) +
theme_classic()
# Q2: How does CH4 flux change by temperature?
ggplot(all_fluxes_seasonal_avg, aes(x = temp, y = mean_mound_fluxCH4, color = campaign))+
geom_point()+
facet_wrap(~species_s)+
geom_smooth(method = 'lm', se = TRUE)+
ylab("CH4 flux umol/d/m2")+
xlab("Average Mound Surface Temperature (C)")+
scale_color_brewer(palette = "Dark2")+
theme_classic()
mod <- lmer(mean_mound_fluxCH4 ~ temp*species_s*campaign + (1 | sample), data = all_fluxes_seasonal_avg)
Anova(mod)
# Q2: How does CH4 flux change by temperature?
ggplot(all_fluxes_seasonal_avg, aes(x = temp, y = mean_mound_fluxCH4, color = campaign))+
geom_point()+
geom_smooth(method = 'lm', se = TRUE)+
ylab("CH4 flux umol/d/m2")+
xlab("Average Mound Surface Temperature (C)")+
scale_color_brewer(palette = "Dark2")+
theme_classic()
# Q2: How does CH4 flux change by temperature?
mod <- lmer(mean_mound_fluxCH4 ~ temp  + campaign + (1 | sample) + (1 | species_s), data = all_fluxes_seasonal_avg)
summary(mod)
Anova(mod)
ggpredict(mod, terms = c("temp", "campaign")) %>% plot(add.data = TRUE)
Anova(mod)
summary(mod)
# Q2: How does CH4 flux change by temperature?
mod <- lmer(mean_mound_fluxCH4 ~ temp*campaign + (1 | sample) + (1 | species_s), data = all_fluxes_seasonal_avg)
Anova(mod)
# Q2: How does CH4 flux change by temperature?
mod <- lmer(mean_mound_fluxCH4 ~ temp*species_s + campaign + (1 | sample), data = all_fluxes_seasonal_avg)
Anova(mod)
# Q2: How does CH4 flux change by temperature?
mod <- lmer(mean_mound_fluxCH4 ~ temp + campaign + (1 | sample) + (1 | species_s), data = all_fluxes_seasonal_avg)
mod1 <- lmer(mean_mound_fluxCH4 ~ temp + (1 | sample) + (1 | species_s), data = all_fluxes_seasonal_avg)
AIC(mod, mod1)
# Q2: How does CH4 flux change by temperature?
mod <- lmer(mean_mound_fluxCH4 ~ temp + campaign + (1 | sample) + (1 | species_s), data = all_fluxes_seasonal_avg)
Anova(mod)
# POLYNOMIAL
mod_poly <- lmer(mean_mound_fluxCH4 ~ poly(temp, 2) + campaign + (1 | sample) + (1 | species_s), data = all_fluxes_seasonal_avg)
summary(mod_poly)
Anova(mod_poly)
residuals <- resid(mod_poly)
fitted_values <- fitted(mod_poly)
plot(fitted_values, residuals, main = "Residuals vs Fitted Values",
xlab = "Fitted Values", ylab = "Residuals")
abline(h = 0, col = "red")
qqnorm(resid(mod_poly))
qqline(resid(mod_poly))
# POLYNOMIAL
new_data <- expand.grid(
temp = seq(min(all_fluxes_seasonal_avg$temp), max(all_fluxes_seasonal_avg$temp), length.out = 100),
species_s = unique(all_fluxes_seasonal_avg$species_s),
campaign = unique(all_fluxes_seasonal_avg$campaign)
)
new_data$predicted_flux <- predict(mod_poly, newdata = new_data, re.form = NA)
ggplot(new_data, aes(x = temp, y = predicted_flux, color = campaign)) +
geom_line(aes(linetype = campaign)) +  # Different linetypes for campaigns
facet_wrap(~ species_s) +              # Separate plots for each species
labs(
x = "Temperature (°C)",
y = "Predicted CH4 Flux (umol/d/m2)",
title = "Polynomial Relationship between Temperature and CH4 Flux"
) +
theme_minimal() +
theme(legend.position = "bottom")
ggplot(new_data, aes(x = temp, y = predicted_flux, color = campaign)) +
geom_line(aes(linetype = campaign)) +  # Different linetypes for campaigns
#facet_wrap(~ species_s) +              # Separate plots for each species
labs(
x = "Temperature (°C)",
y = "Predicted CH4 Flux (umol/d/m2)",
title = "Polynomial Relationship between Temperature and CH4 Flux"
) +
theme_minimal() +
theme(legend.position = "bottom")
Anova(mod_poly)
# POLYNOMIAL
mod_poly <- lmer(mean_mound_fluxCH4 ~ poly(temp, 2) + campaign + (1 | sample) + (1 | species_s), data = all_fluxes_seasonal_avg)
Anova(mod_poly)
# Q2: How does CH4 flux change by temperature?
# LINEAR
mod <- lmer(mean_mound_fluxCH4 ~ temp * campaign + (1 | sample) + (1 | species_s), data = all_fluxes_seasonal_avg)
Anova(mod)
# POLYNOMIAL
mod_poly <- lmer(mean_mound_fluxCH4 ~ poly(temp, 2) * campaign + (1 | sample) + (1 | species_s), data = all_fluxes_seasonal_avg)
Anova(mod_poly)
