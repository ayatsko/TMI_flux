t <- avgflux %>%
arrange(x) %>%
group_by(species_s)
View(t)
q1_samples <- q1_out %>% select(extract_ID, top_emitters, rank)
q1_samples <- q1_samps %>% select(extract_ID, top_emitters, rank)
View(q1_samples)
y <- left_join(y, q1_samples)
table(y$species_s, y$rank)
View(q1_samps_ami)
View(mounds)
View(mounds)
# MD3-1-mid, MD3-2-low, MD3-4-mid
yy <- y %>%
mutate(
species_s = ifelse(extract_ID == "MD3-1-mid", "A. laurensis", species_s),
top_emitters = ifelse(extract_ID == "MD3-1-mid", "y", top_emitters),
rank = ifelse(extract_ID == "MD3-1-mid", "bottom", rank),
species_s = ifelse(extract_ID == "MD3-2-low", "A. laurensis", species_s),
top_emitters = ifelse(extract_ID == "MD3-2-low", "y", top_emitters),
rank = ifelse(extract_ID == "MD3-2-low", "bottom", rank),
species_s = ifelse(extract_ID == "MD3-4-mid", "A. laurensis", species_s),
top_emitters = ifelse(extract_ID == "MD3-4-mid", "y", top_emitters),
rank = ifelse(extract_ID == "MD3-4-mid", "bottom", rank)
)
View(yy)
table(y$species_s, y$rank)
table(yy$species_s, yy$rank)
# MD3-1-mid, MD3-2-low, MD3-4-mid
y <- y %>%
mutate(
species_s = ifelse(extract_ID == "MD3-1-mid", "A. laurensis", species_s),
top_emitters = ifelse(extract_ID == "MD3-1-mid", "y", top_emitters),
rank = ifelse(extract_ID == "MD3-1-mid", "bottom", rank),
species_s = ifelse(extract_ID == "MD3-2-low", "A. laurensis", species_s),
top_emitters = ifelse(extract_ID == "MD3-2-low", "y", top_emitters),
rank = ifelse(extract_ID == "MD3-2-low", "bottom", rank),
species_s = ifelse(extract_ID == "MD3-4-mid", "A. laurensis", species_s),
top_emitters = ifelse(extract_ID == "MD3-4-mid", "y", top_emitters),
rank = ifelse(extract_ID == "MD3-4-mid", "bottom", rank)
)
# join in Q2 metadata
q2_samples <- q2_samps %>% select(extract_ID, variable_emitters)
View(q2_samples)
# join in Q2 metadata
q2_samples <- q2_samps %>% select(extract_ID, species_s, variable_emitters)
table(q2_samples$species_s)
View(y)
y <- left_join(y, q2_samples)
y <- left_join(y, q2_samples, by = extract_ID)
y <- left_join(y, q2_samples, by = c("extract_ID"))
# join in Q1 metadata
y <- left_join(y, q1_samples)
# MD3-1-mid, MD3-2-low, MD3-4-mid
y <- y %>%
mutate(
species_s = ifelse(extract_ID == "MD3-1-mid", "A. laurensis", species_s),
top_emitters = ifelse(extract_ID == "MD3-1-mid", "y", top_emitters),
rank = ifelse(extract_ID == "MD3-1-mid", "bottom", rank),
species_s = ifelse(extract_ID == "MD3-2-low", "A. laurensis", species_s),
top_emitters = ifelse(extract_ID == "MD3-2-low", "y", top_emitters),
rank = ifelse(extract_ID == "MD3-2-low", "bottom", rank),
species_s = ifelse(extract_ID == "MD3-4-mid", "A. laurensis", species_s),
top_emitters = ifelse(extract_ID == "MD3-4-mid", "y", top_emitters),
rank = ifelse(extract_ID == "MD3-4-mid", "bottom", rank)
)
# join in Q2 metadata
q2_samples <- q2_samps %>% select(extract_ID, species_s, variable_emitters)
y <- left_join(y, q2_samples, by = c("extract_ID"))
# compare with sequencing metadata sheet
y <- read.csv("/Users/abbeyyatsko/Downloads/abb/sample_metadata.csv")
# compare with sequencing metadata sheet
y <- read.csv("/Users/abbeyyatsko/Downloads/abb/sample_metadata.csv")
# join in Q1 metadata
q1_samples <- q1_samps %>% select(extract_ID, top_emitters, rank)
y <- left_join(y, q1_samples)
# MD3-1-mid, MD3-2-low, MD3-4-mid
y <- y %>%
mutate(
species_s = ifelse(extract_ID == "MD3-1-mid", "A. laurensis", species_s),
top_emitters = ifelse(extract_ID == "MD3-1-mid", "y", top_emitters),
rank = ifelse(extract_ID == "MD3-1-mid", "bottom", rank),
species_s = ifelse(extract_ID == "MD3-2-low", "A. laurensis", species_s),
top_emitters = ifelse(extract_ID == "MD3-2-low", "y", top_emitters),
rank = ifelse(extract_ID == "MD3-2-low", "bottom", rank),
species_s = ifelse(extract_ID == "MD3-4-mid", "A. laurensis", species_s),
top_emitters = ifelse(extract_ID == "MD3-4-mid", "y", top_emitters),
rank = ifelse(extract_ID == "MD3-4-mid", "bottom", rank)
)
# join in Q2 metadata
q2_samples <- q2_samps %>% select(extract_ID, species_s, variable_emitters)
y <- left_join(y, q2_samples, by = c("extract_ID"))
table(y$variable_emitters, y$species_s.x)
table(y$variable_emitters, y$species_s.y)
y <- y %>%
mutate(species = coalesce(species_s.x, species_s.y))
y <- y %>%
mutate(species = coalesce(species_s.x, species_s.y))%>%
select(-species_s.x, -species_s.y)
# subset y for variable_emitters == "y'
yt <- y %>% filter(variable_emitters == "y")
View(yt)
table(yt$sample, yt$species)
View(mounds)
View(minmax)
View(q1_samps)
View(q2_samps)
y <- y %>%
mutate(
species_s = ifelse(extract_ID == "MD39-3-mid", "N. magnus", species_s),
variable_emitters = ifelse(extract_ID == "MD39-3-mid", "y", variable_emitters)
)
y <- y %>%
mutate(
species = ifelse(extract_ID == "MD39-3-mid", "N. magnus", species),
variable_emitters = ifelse(extract_ID == "MD39-3-mid", "y", variable_emitters)
)
View(q1_all)
View(q1)
View(q1H)
View(q1)
avgflux %>%
arrange(x) %>%
group_by(species_s)
u <- avgflux %>%
arrange(x) %>%
group_by(species_s)
View(u)
View(u)
# MD39-3-mid should be included in variable emitters
# MD50 add to top_emitters (MD50-2-low, MD50-3-low, MD50-4-mid)
y <- y %>%
mutate(
species = ifelse(extract_ID == "MD39-3-mid", "N. magnus", species),
variable_emitters = ifelse(extract_ID == "MD39-3-mid", "y", variable_emitters),
species = ifelse(extract_ID == "MD50-2-low", "N. magnus", species),
top_emitters = ifelse(extract_ID == "MD50-2-low", "y", top_emitters),
rank = ifelse(extract_ID == "MD50-2-low", "top", rank),
species = ifelse(extract_ID == "MD50-3-low", "N. magnus", species),
top_emitters = ifelse(extract_ID == "MD50-3-low", "y", top_emitters),
rank = ifelse(extract_ID == "MD50-3-low", "top", rank),
species = ifelse(extract_ID == "MD50-4-mid", "N. magnus", species),
top_emitters = ifelse(extract_ID == "MD50-4-mid", "y", top_emitters),
rank = ifelse(extract_ID == "MD50-4-mid", "top", rank)
)
View(mounds)
u <- minmax %>%
arrange(desc(range)) %>%
group_by(species_s)
View(u)
# MD39-3-mid should be included in variable emitters
# MD50 add to top_emitters (MD50-2-low, MD50-3-low, MD50-4-mid)
# MD38 add as variable_emitters (even though it is not really a top variable emitter)
y <- y %>%
mutate(
species = ifelse(extract_ID == "MD39-3-mid", "N. magnus", species),
variable_emitters = ifelse(extract_ID == "MD39-3-mid", "y", variable_emitters),
species = ifelse(extract_ID == "MD50-2-low", "N. magnus", species),
top_emitters = ifelse(extract_ID == "MD50-2-low", "y", top_emitters),
rank = ifelse(extract_ID == "MD50-2-low", "top", rank),
species = ifelse(extract_ID == "MD50-3-low", "N. magnus", species),
top_emitters = ifelse(extract_ID == "MD50-3-low", "y", top_emitters),
rank = ifelse(extract_ID == "MD50-3-low", "top", rank),
species = ifelse(extract_ID == "MD50-4-mid", "N. magnus", species),
top_emitters = ifelse(extract_ID == "MD50-4-mid", "y", top_emitters),
rank = ifelse(extract_ID == "MD50-4-mid", "top", rank),
species = ifelse(sample == "MD38", "N. magnus", species),
variable_emitters = ifelse(sample == "MD38", "y", variable_emitters)
)
# add in variable_emitters range values
u <- minmax %>% arrange(desc(range)) %>%
group_by(species_s)
View(u)
# add in variable_emitters range values
u <- minmax %>% arrange(desc(range)) %>%
group_by(species_s) %>%
select(range, sample)
left_join(y, u, by = c("sample" = "sample"))
y <- left_join(y, u, by = c("sample" = "sample"))
u <- minmax %>% arrange(desc(range)) %>%
group_by(species_s) %>%
mutate(range_rank = row_number())
View(u)
# add in variable_emitters range values
u <- minmax %>% arrange(desc(range)) %>%
group_by(species_s) %>%
mutate(range_rank = row_number()) %>%
select(range, range_rank, sample)
y <- left_join(y, u, by = c("sample" = "sample"))
y_rank <- y[y$variable_emitters == "y",] %>% arrange(range_rank)]
y_rank <- y[y$variable_emitters == "y",]
View(y_rank)
y_rank <- y[y$variable_emitters == "y",]
y_rank <- y[y$variable_emitters == "y",]
View(y_rank)
# subset y for variable_emitters == 'y'
z <- y %>% filter(variable_emitters == 'y')
View(z)
table(z$species, z$sample)
write.csv(y, "/Users/abbeyyatsko/Desktop/repos/TMI_flux/data/data_out/metagenomes_metadata.csv", row.names = FALSE)
y <- read.csv("/Users/abbeyyatsko/Downloads/abb/sample_metadata.csv")
# join in Q1 metadata
q1_samples <- q1_samps %>% select(extract_ID, top_emitters, rank)
y <- left_join(y, q1_samples)
# MD41 is not here and it should be. need another bottom emitter for Amitermes - use MD3, tags 1, 2, 4
# MD3-1-mid, MD3-2-low, MD3-4-mid
y <- y %>%
mutate(
species_s = ifelse(extract_ID == "MD3-1-mid", "A. laurensis", species_s),
top_emitters = ifelse(extract_ID == "MD3-1-mid", "y", top_emitters),
rank = ifelse(extract_ID == "MD3-1-mid", "bottom", rank),
species_s = ifelse(extract_ID == "MD3-2-low", "A. laurensis", species_s),
top_emitters = ifelse(extract_ID == "MD3-2-low", "y", top_emitters),
rank = ifelse(extract_ID == "MD3-2-low", "bottom", rank),
species_s = ifelse(extract_ID == "MD3-4-mid", "A. laurensis", species_s),
top_emitters = ifelse(extract_ID == "MD3-4-mid", "y", top_emitters),
rank = ifelse(extract_ID == "MD3-4-mid", "bottom", rank)
)
# join in Q2 metadata
q2_samples <- q2_samps %>% select(extract_ID, species_s, variable_emitters)
y <- left_join(y, q2_samples, by = c("extract_ID"))
y <- y %>%
mutate(species = coalesce(species_s.x, species_s.y)) %>%
select(-species_s.x, -species_s.y)
# MD39 only has 4 measurement points even though it is a N. magnus (which usually has 5)
# MD51 only has 3 measurement points even though it is a N. magnus (which usually has 5)
# MD39-3-mid should be included in variable emitters
# MD50 add to top_emitters (MD50-2-low, MD50-3-low, MD50-4-mid)
# MD38 add as variable_emitters (even though it is not really a top variable emitter)
y <- y %>%
mutate(
species = ifelse(extract_ID == "MD39-3-mid", "N. magnus", species),
variable_emitters = ifelse(extract_ID == "MD39-3-mid", "y", variable_emitters),
species = ifelse(extract_ID == "MD50-2-low", "N. magnus", species),
top_emitters = ifelse(extract_ID == "MD50-2-low", "y", top_emitters),
rank = ifelse(extract_ID == "MD50-2-low", "top", rank),
species = ifelse(extract_ID == "MD50-3-low", "N. magnus", species),
top_emitters = ifelse(extract_ID == "MD50-3-low", "y", top_emitters),
rank = ifelse(extract_ID == "MD50-3-low", "top", rank),
species = ifelse(extract_ID == "MD50-4-mid", "N. magnus", species),
top_emitters = ifelse(extract_ID == "MD50-4-mid", "y", top_emitters),
rank = ifelse(extract_ID == "MD50-4-mid", "top", rank),
species = ifelse(sample == "MD38", "N. magnus", species),
variable_emitters = ifelse(sample == "MD38", "y", variable_emitters)
)
# add in variable_emitters range values
u <- minmax %>% arrange(desc(range)) %>%
group_by(species_s) %>%
mutate(range_rank = row_number()) %>%
select(range, range_rank, sample)
y <- left_join(y, u, by = c("sample" = "sample"))
write.csv(y, "/Users/abbeyyatsko/Desktop/repos/TMI_flux/data/data_out/metagenomes_metadata.csv", row.names = FALSE)
variable <- y %>% filter(variable_emitters == 'y')
top <- y %>% filter(top_emitters == 'y')
View(variable)
View(top)
z <- y %>% filter(variable_emitters == 'y')
table(variable$species)
unique(variable$sample)
metadata <- read.csv("/Users/abbeyyatsko/Desktop/repos/TMI_flux/data/data_out/metagenomes_metadata.csv")
top_e <- read.csv("/Users/abbeyyatsko/Desktop/repos/TMI_flux/data/data_out/q1_top_emitters.csv")
var_e <- read.csv("/Users/abbeyyatsko/Desktop/repos/TMI_flux/data/data_out/q2_variable_emitters.csv")
View(metadata)
fluxes <- read.csv("/Users/abbeyyatsko/Desktop/repos/TMI_flux/data/finalfluxes/all_fluxes_mound.csv")
View(fluxes)
fluxes <- fluxes[fluxes$campaign == "may22", ]
View(fluxes)
fluxes$extract_ID <- paste(fluxes$sample,"-",fluxes$tag, "-", fluxes$position, sep = "")
# select extract_ID and flux.ch4 from fluxes df
x <- fluxes[, c("extract_ID", "flux.ch4")]
# select extract_ID and flux.ch4 from fluxes df
x <- fluxes[, c("extract_ID", "flux.CH4")]
View(x)
# merge x and metadata
out <- merge(x, metadata, by = "extract_ID")
View(out)
# merge x and metadata
metadata <- merge(x, metadata, by = "extract_ID")
targets <- read.csv("/Users/abbeyyatsko/Desktop/repos/TMI_flux/data/metagenomes/targets.csv")
View(targets)
View(top_e)
ko_table <- read.delim("/Users/abbeyyatsko/Desktop/repos/TMI_flux/data/metagenomes/ko.table(ReadsPerSample).txt", header = TRUE, sep = "\t")
View(ko_table)
ko <- read.delim("/Users/abbeyyatsko/Desktop/repos/TMI_flux/data/metagenomes/ko.table(ReadsPerSample).txt", header = TRUE, sep = "\t")
pathway <- read.delim("/Users/abbeyyatsko/Desktop/repos/TMI_flux/data/metagenomes/pathway.table(ReadsPerSample).txt", header = TRUE, sep = "\t")
cazymes <- read.delim("/Users/abbeyyatsko/Desktop/repos/TMI_flux/data/metagenomes/CAZy.single.table(ReadsPerSample).txt", header = TRUE, sep = "\t")
View(ko)
View(pathway)
View(cazymes)
View(targets)
# filter ko table for what is in the target list
ko_targets <- targets$target[targets$source == "ko", ]
targets$target
# filter ko table for what is in the target list
ko_targets <- targets[targets$source == "ko", ]
View(ko_targets)
# filter ko table for what is in the target list
ko_targets <- targets[targets$source == "ko", ]$target
ko_targets
View(ko_table)
# filter ko_table by Annotation = ko_targets
out <- ko_table[ko_table$Annotation %in% ko_targets, ]
View(out)
# filter ko_table by Annotation = ko_targets
ko_table_targets <- ko_table[ko_table$Annotation %in% ko_targets, ]
View(ko_table_targets)
# ko_table_targets to long format
ko_table_targets_l <- ko_table_targets %>%
pivot_longer(cols = -Annotation, names_to = "sample", values_to = "reads") %>%
mutate(sample = gsub("X", "", sample))
library(dplyr)
# ko_table_targets to long format
ko_table_targets_l <- ko_table_targets %>%
pivot_longer(cols = -Annotation, names_to = "sample", values_to = "reads") %>%
mutate(sample = gsub("X", "", sample))
library(tidyr)
# ko_table_targets to long format
ko_table_targets_l <- ko_table_targets %>%
pivot_longer(cols = -Annotation, names_to = "sample", values_to = "reads") %>%
mutate(sample = gsub("X", "", sample))
# remove first column
ko_table_targets <- ko_table_targets[, -1]
# ko_table_targets to long format
ko_table_targets_l <- ko_table_targets %>%
pivot_longer(cols = -Annotation, names_to = "sample", values_to = "reads") %>%
mutate(sample = gsub("X", "", sample))
View(ko_table_targets_l)
View(metadata)
metadata_ko <- metadata[, c("sequencing_id", "extract_ID", "flux.CH4")]
View(metadata_ko)
# ko_table_targets to long format
ko_table_targets_l <- ko_table_targets %>%
pivot_longer(cols = -Annotation, names_to = "sequencing_id", values_to = "reads") %>%
mutate(sample = gsub("X", "", sequencing_id))
out <- merge(ko_table_targets_l, metadata_ko)
View(out)
View(metadata)
metadata_ko <- metadata[, c("sequencing_id", "extract_ID", "flux.CH4", "top_emitters", "variable_emitters", "rank")]
out <- merge(ko_table_targets_l, metadata_ko)
View(out)
# reads ~ flux.CH4
ggplot(out, aes(x = reads, y = flux.CH4)) +
geom_point() +
facet_wrap(~Annotation) +
labs(title = "reads ~ flux.CH4", x = "reads", y = "flux.CH4")
library(ggplot2)
# reads ~ flux.CH4
ggplot(out, aes(x = reads, y = flux.CH4)) +
geom_point() +
facet_wrap(~Annotation) +
labs(title = "reads ~ flux.CH4", x = "reads", y = "flux.CH4")
# reads ~ flux.CH4
ggplot(out, aes(x = reads, y = flux.CH4)) +
geom_point() +
facet_wrap(~Annotation, scales = "free") +
labs(title = "reads ~ flux.CH4", x = "reads", y = "flux.CH4")
# reads ~ flux.CH4
ggplot(out, aes(x = reads, y = flux.CH4)) +
geom_point() +
geom_line() +
facet_wrap(~Annotation, scales = "free") +
labs(title = "reads ~ flux.CH4", x = "reads", y = "flux.CH4")
# reads ~ flux.CH4
ggplot(out, aes(x = reads, y = flux.CH4)) +
geom_point() +
geom_smooth() +
facet_wrap(~Annotation, scales = "free") +
labs(title = "reads ~ flux.CH4", x = "reads", y = "flux.CH4")
# reads ~ flux.CH4
ggplot(out, aes(x = reads, y = flux.CH4)) +
geom_point() +
geom_smooth(method = "lm") +
facet_wrap(~Annotation, scales = "free") +
labs(title = "reads ~ flux.CH4", x = "reads", y = "flux.CH4")
metadata_ko <- metadata[, c("sequencing_id", "extract_ID", "flux.CH4", "top_emitters", "variable_emitters", "rank", "species")]
metadata_ko <- metadata[, c("sequencing_id", "extract_ID", "flux.CH4", "top_emitters", "variable_emitters", "rank", "species")]
metadata_ko <- merge(ko_table_targets_l, metadata_ko)
# reads ~ flux.CH4
ggplot(metadata_ko, aes(x = reads, y = flux.CH4)) +
geom_point() +
geom_smooth(method = "lm") +
facet_wrap(species~Annotation, scales = "free") +
labs(title = "reads ~ flux.CH4", x = "reads", y = "flux.CH4")
# reads ~ flux.CH4
ggplot(metadata_ko, aes(x = reads, y = flux.CH4)) +
geom_point() +
geom_smooth(method = "lm") +
facet_wrap(species~Annotation, scales = "free", ncol = 6) +
labs(title = "reads ~ flux.CH4", x = "reads", y = "flux.CH4")
View(ko)
# filter ko_table by Annotation = ko_targets
ko_table_targets <- ko[ko$Annotation %in% ko_targets, ]
# shorten annotation
ko_table_targets_l$Annotation_s <- str_extract(ko_table_targets_l$Annotation, "^[^;]*")
library(stringr)
# shorten annotation
ko_table_targets_l$Annotation_s <- str_extract(ko_table_targets_l$Annotation, "^[^;]*")
# reads ~ flux.CH4
ggplot(metadata_ko, aes(x = reads, y = flux.CH4)) +
geom_point() +
geom_smooth(method = "lm") +
facet_wrap(species~Annotation_s, scales = "free", ncol = 6) +
labs(title = "reads ~ flux.CH4", x = "reads", y = "flux.CH4")+
theme_classic()
# shorten annotation
ko_table_targets_l$Annotation_s <- str_extract(ko_table_targets_l$Annotation, "^[^;]*")
metadata_ko <- metadata[, c("sequencing_id", "extract_ID", "flux.CH4", "top_emitters", "variable_emitters", "rank", "species")]
metadata_ko <- merge(ko_table_targets_l, metadata_ko)
# reads ~ flux.CH4
ggplot(metadata_ko, aes(x = reads, y = flux.CH4)) +
geom_point() +
geom_smooth(method = "lm") +
facet_wrap(species~Annotation_s, scales = "free", ncol = 6) +
labs(title = "reads ~ flux.CH4", x = "reads", y = "flux.CH4")+
theme_classic()
pmoA_dat <- metadata_ko[metadata_ko$Annotation_s == "pmoA-amoA", ]
View(pmoA_dat)
mod <- lm(flux.CH4 ~ reads + species, data = pmoA_dat)
summary(mod)
Anova(mod)
library(car)
Anova(mod)
pmoB_dat <- metadata_ko[metadata_ko$Annotation_s == "pmoB-amoB", ]
mod <- lm(flux.CH4 ~ reads + species, data = pmoB_dat)
Anova(mod)
mod <- lm(flux.CH4 ~ reads, data = pmoB_dat)
Anova(mod)
mod <- lm(flux.CH4 ~ reads, data = pmoA_dat)
# reads ~ flux.CH4
ggplot(metadata_ko, aes(x = reads, y = flux.CH4)) +
geom_point() +
geom_smooth(method = "lm") +
facet_wrap(~Annotation_s, scales = "free", ncol = 2) +
labs(title = "reads ~ flux.CH4", x = "reads", y = "flux.CH4")+
theme_classic()
# filter ko table for what is in the target list
pathway_targets <- targets[targets$source == "pathway", ]$target
# filter ko_table by Annotation = ko_targets
pathway_table_targets <- pathway[pathway$Annotation %in% pathway_targets, ]
View(pathway_table_targets)
View(pathway)
# filter ko_table by Annotation = ko_targets
pathway_table_targets <- pathway[pathway$pathway %in% pathway_targets, ]
View(pathway_table_targets)
View(ko_table_targets)
View(ko_table_targets_l)
View(pathway_table_targets)
# remove first column
pathway_table_targets <- pathway_table_targets[, -1]
# ko_table_targets to long format
pathway_table_targets_l <- pathway_table_targets %>%
pivot_longer(cols = -pathway, names_to = "sequencing_id", values_to = "reads") %>%
mutate(sample = gsub("X", "", sequencing_id))
View(pathway_table_targets_l)
pathway_table_targets_l <- pathway_table_targets %>%
pivot_longer(cols = -pathway, names_to = "sequencing_id", values_to = "reads")
data_ko <- merge(ko_table_targets_l, metadata_ko)
data_pathway <- merge(pathway_table_targets_l, metadata_ko)
View(data_pathway)
View(metadata_ko)
# ko_table_targets to long format
pathway_table_targets_l <- pathway_table_targets %>%
pivot_longer(cols = -pathway, names_to = "sample", values_to = "reads")
data_pathway <- merge(pathway_table_targets_l, metadata_ko)
merge(pathway_table_targets_l, metadata_ko)
View(metadata_ko)
metadata_pathway <- metadata[, c("sequencing_id", "extract_ID", "flux.CH4", "top_emitters", "variable_emitters", "rank", "species")]
View(metadata_pathway)
# ko_table_targets to long format
pathway_table_targets_l <- pathway_table_targets %>%
pivot_longer(cols = -pathway, names_to = "sequencing_id", values_to = "reads")
data_pathway <- merge(pathway_table_targets_l, metadata_ko)
View(metadata_pathway)
data_pathway <- merge(pathway_table_targets_l, metadata_pathway)
View(data_pathway)
View(metadata)
metadata_pathway <- metadata[, c("sequencing_id", "extract_ID", "flux.CH4", "top_emitters", "variable_emitters", "rank", "species")]
data_pathway <- merge(pathway_table_targets_l, metadata_pathway)
ggplot(data_pathway, aes(x = reads, y = flux.CH4)) +
geom_point() +
geom_smooth(method = "lm")
# reads ~ flux.CH4 (pathways)
ggplot(data_pathway, aes(x = reads, y = flux.CH4)) +
geom_point() +
geom_smooth(method = "lm") +
facet_wrap(~species) +
labs(title = "reads ~ flux.CH4", x = "reads", y = "flux.CH4")+
theme_classic()
mod <- lm(flux.CH4 ~ reads, data = data_pathway)
Anova(mod)
# omit rows = NA for column rank
data_pathway_q1 <- data_pathway[!is.na(data_pathway$rank), ]
View(data_pathway_q1)
ggplot(data_pathway_q1, aes(x = species, y = flux.CH4, fill = rank)) +
geom_boxplot() +
theme_classic())
ggplot(data_pathway_q1, aes(x = species, y = flux.CH4, fill = rank)) +
geom_boxplot() +
theme_classic()
ggplot(data_pathway_q1, aes(x = species, y = reads, fill = rank)) +
geom_boxplot() +
theme_classic()
data_ko_q1 <- data_ko[!is.na(data_ko$rank), ]
View(data_ko_q1)
ggplot(data_ko_q1, aes(x = species, y = reads, fill = rank)) +
geom_boxplot() +
facet_wrap(~Annotation_s) +
theme_classic()
ggplot(data_ko_q1, aes(x = species, y = reads, fill = rank)) +
geom_boxplot() +
facet_wrap(~Annotation_s, scales = "free") +
theme_classic()
