---
title: "2.prelim_fluxviz"
author: "abbey yatsko"
date: "26/08/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(dplyr)
library(ggpubr)
```

## read in data 
```{r data load}
CO2_fluxfinal <- read.csv("/Users/abbeyyatsko/Downloads/CO2_fluxfinalTMI.csv")
CH4_fluxfinal<- read.csv("/Users/abbeyyatsko/Downloads/CH4_fluxfinalTMI.csv")
```

## methane flux by mound
```{r flux}
# subset df to create just soils and just mounds
soils <- CH4_fluxfinal[CH4_fluxfinal$flux_source == 's',]
mounds <- CH4_fluxfinal[CH4_fluxfinal$flux_source == 'm',]

# mounds all 
a1 <- ggplot(data = mounds, aes(x = as.factor(sample), y = flux.CH4)) + 
  geom_boxplot()+ 
  geom_jitter()+
  theme_classic()+
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
  labs(title = "mound")

# soils all 
a2 <- ggplot(data = soils, aes(x = as.factor(sample), y = flux.CH4)) + 
  geom_boxplot()+ 
  geom_jitter()+
  theme_classic()+
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
  labs(title = "soil")
ggarrange(a1, a2, ncol=1)
```

# methane flux by mound or soil measurement 
```{r by soil/mound}
b <- ggplot(data = CH4_fluxfinal, aes(x = as.factor(flux_source), y = flux.CH4)) + 
  geom_boxplot()+ 
  geom_jitter()+
  theme_light()
```

# methane flux by factor(position)
```{r by position}
c <- ggplot(data = CH4_fluxfinal, aes(x = as.factor(position), y = flux.CH4)) + 
  geom_boxplot()+ 
  geom_jitter()+
  theme_light()
```

# methane flux by factor(direction)
```{r by direction}
d <- ggplot(data = CH4_fluxfinal, aes(x = as.factor(directon), y = flux.CH4, fill = flux_source)) + 
  geom_boxplot()+ 
  geom_jitter()+
  theme_light()
```

# methane flux by factor(species) - note that species info is not complete yet 
```{r by species}
species <- read.csv("/Users/abbeyyatsko/Downloads/Abbey termites .xlsx - Sheet1.csv")
sp <- species[c("X", "ID_cleaned")]

# merge sp and CH4flux_final 
sp <- sp %>%
  rename(sample = X)
CH4_fluxfinal <- merge(CH4_fluxfinal, sp, by = c("sample")) 

e <- ggplot(data = CH4_fluxfinal, aes(x = as.factor(ID_cleaned), y = flux.CH4, fill = flux_source)) + 
  geom_boxplot()+ 
  theme_light()
```

# methane flux by methane:co2 
```{r}
# new column for methane:co2 
CH4_fluxfinal$ch4_co2 <-  CH4_fluxfinal$flux.CH4/CO2_fluxfinal$flux.CO2
  
f <- ggplot(data = CH4_fluxfinal, aes(x = as.factor(ID_cleaned), y = ch4_co2, fill = flux_source)) + 
  geom_boxplot()+ 
  geom_jitter()+
  theme_light()+
  scale_y_continuous(limits = c(-1, 50))
```

# methane flux by species faceted with mound/soil and positioning
```{r}
g <- ggplot(data = CH4_fluxfinal, aes(x = as.factor(ID_cleaned), y = flux.CH4, fill = flux_source)) + 
  geom_boxplot()+ 
  geom_point(aes(col=position), position = "jitter")+
  theme_light()
```




